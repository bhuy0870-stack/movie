{% extends "admin/change_list.html" %}
{% load static %}
{% block content_title %} 
    <div style="margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 15px;">
        <h1 class="mb-0 text-white" style="font-weight: 800; font-size: 26px;">
            <i class="fas fa-comment-dots text-info"></i> QU·∫¢N L√ù ƒê√ÅNH GI√Å
        </h1>
    </div>
{% endblock %}

{% block result_list %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    .stat-card{background:linear-gradient(145deg, #1e1e1e, #252525);padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,0.05);text-align:center;color:#fff;box-shadow:0 4px 10px rgba(0,0,0,0.2);} 
    .chart-box{background:#1e1e1e;padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,0.05); box-shadow:0 4px 10px rgba(0,0,0,0.2);}
    .card-title-lg { font-size: 2.5rem; margin: 0; font-weight: 800; }
    .card-sub { color: #aaa; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 1px; margin-top: 5px; }
</style>

<div style="display:grid; grid-template-columns:repeat(3, 1fr); gap:20px; margin-bottom:30px;">
    <div class="stat-card">
        <h2 class="card-title-lg" style="color:#ffc107;">{{ stats.total_reviews }}</h2>
        <div class="card-sub">T·ªîNG REVIEW</div>
    </div>
    <div class="stat-card">
        <h2 class="card-title-lg" style="color:#fff;">{{ stats.avg_rating }} <small style="font-size:1.5rem">‚òÖ</small></h2>
        <div class="card-sub">TRUNG B√åNH</div>
    </div>
    <div class="stat-card">
        <h2 class="card-title-lg" style="color:#0dcaf0;">{{ stats.five_star }}</h2>
        <div class="card-sub">ƒê·∫†T 5 SAO</div>
    </div>
</div>

<div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-bottom:30px;">
    <div class="chart-box">
        <h4 style="color:#e0e0e0; margin-bottom:20px; border-left:4px solid #ffc107; padding-left:10px;">üìä Ph√¢n b·ªë sao</h4>
        <div style="height:280px;"><canvas id="rBar"></canvas></div>
    </div>
    <div class="chart-box">
        <h4 style="color:#e0e0e0; margin-bottom:20px; border-left:4px solid #fd7e14; padding-left:10px;">üìà Xu h∆∞·ªõng ƒë√°nh gi√°</h4>
        <div style="height:280px;"><canvas id="rLine"></canvas></div>
    </div>
</div>

<script>
    Chart.defaults.color = '#bbb';
    new Chart(document.getElementById('rBar'), {
        type:'bar',
        data:{
            labels:{{stats.bar_labels|safe}},
            datasets:[{
                label:'S·ªë l∆∞·ª£ng',
                data:{{stats.bar_data|safe}},
                backgroundColor:['#dc3545','#fd7e14','#ffc107','#20c997','#0d6efd'],
                borderRadius: 4
            }]
        },
        options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{grid:{display:false}},y:{grid:{color:'#333'}}}}
    });
    new Chart(document.getElementById('rLine'), {
        type:'line',
        data:{
            labels:{{stats.line_labels|safe}},
            datasets:[{
                label:'Reviews',
                data:{{stats.line_data|safe}},
                borderColor:'#ffc107',
                backgroundColor:'rgba(255,193,7,0.1)',
                borderWidth:2, fill:true, tension:0.4
            }]
        },
        options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{grid:{display:false}},y:{grid:{color:'#333'}}}}
    });
</script>
{{ block.super }}
{% endblock %}